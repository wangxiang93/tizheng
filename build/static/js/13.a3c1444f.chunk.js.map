{"version":3,"sources":["options sync nonrecursive /.js$","options/system.js","pages/subjectManage/depaSubject/EditModal.jsx","pages/subjectManage/depaSubject/index.jsx","options/index.js","../node_modules/antd/es/row/style/index.js","../node_modules/antd/es/col/style/index.js","../node_modules/antd/es/row/index.js","../node_modules/antd/es/col/index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","menuTarget","value","label","yesNo","tag","color","enabled","sex","system","ajax","get","list","item","title","meta","action","config","modal","props","record","isDetail","isEdit","width","top","onOk","onCancel","useState","loading","setLoading","useForm","form","useMemo","setFieldsValue","getDepartList","useGet","run","departOptions","setDepartOptions","useEffect","a","res","content","save","usePost","successTip","update","handleSubmit","useCallback","values","params","disabled","layout","labelCol","flex","name","onFinish","initialValues","okText","okHtmlType","cancelText","footer","onClick","undefined","hidden","gutter","span","required","noSpace","type","fieldKey","fieldNames","children","treeData","path","pageNum","setPageNum","pageSize","setPageSize","conditions","setConditions","visible","setVisible","setRecord","refreshSearch","getFieldsValue","formatResult","dataSource","total","totalElements","data","deleteRecord","useDel","columns","dataIndex","key","render","zhuantimingcheng","items","confirm","onConfirm","handleDelete","queryItem","style","selectedRowKeys","setSelectedRowKeys","handleSelectedRowKeysChange","position","htmlType","resetFields","danger","serialNumber","fitHeight","rowSelection","onChange","rowKey","onPageNumChange","onPageSizeChange","EditModal","result","require","forEach","includes","options","default","entries","k","wrapperOptions","Row","Col"],"mappings":"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","file":"static/js/13.a3c1444f.chunk.js","sourcesContent":["var map = {\n\t\"./index.js\": 995,\n\t\"./system.js\": 1002\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1001;","import { Tag } from 'antd';\r\nimport ajax from 'src/commons/ajax';\r\n\r\n/**\r\n * 项目中可能用到的一些枚举类数据\r\n * 约定只含有三个参数，\r\n * {\r\n *  value: 1,      // 必须且不可重复\r\n *  label: '名称', // 必须\r\n *  meta: {},     // 其他数据，可缺省\r\n *  tag: Tag      // 标签\r\n * };\r\n *\r\n * // 扩展方法\r\n * options.menuTarget.getLabel('menu')\r\n * options.yesNo.getTag(true);\r\n * */\r\nexport default {\r\n    // 菜单目标\r\n    menuTarget: [\r\n        { value: 'menu', label: '应用菜单' },\r\n        { value: 'qiankun', label: '乾坤子应用' },\r\n        { value: 'iframe', label: 'iframe内嵌第三方' },\r\n        { value: '_self', label: '当前窗口打开第三方' },\r\n        { value: '_blank', label: '新开窗口打开第三方' },\r\n    ],\r\n    // 是否\r\n    yesNo: [\r\n        { value: true, label: '是', tag: <Tag color=\"green\">是</Tag> },\r\n        { value: false, label: '否', tag: <Tag color=\"red\">否</Tag> },\r\n    ],\r\n    // 启用、禁用\r\n    enabled: [\r\n        { value: true, label: '启用', tag: <Tag color=\"green\">启用</Tag> },\r\n        { value: false, label: '禁用', tag: <Tag color=\"red\">禁用</Tag> },\r\n    ],\r\n    // 性别\r\n    sex: [\r\n        { value: '1', label: '男' },\r\n        { value: '2', label: '女' },\r\n        { value: '3', label: '未知' },\r\n    ],\r\n    // 可以是函数，异步或同步都可以\r\n    async system() {\r\n        const list = await ajax.get('/menu/queryTopMenus');\r\n        return list.map((item) => {\r\n            return {\r\n                value: item.id,\r\n                label: item.title,\r\n                meta: item,\r\n            };\r\n        });\r\n    },\r\n    action() {\r\n        return [{ value: 'add', label: '添加' }];\r\n        // throw Error('获取失败了');\r\n    },\r\n    // 使用 get\r\n    get demo() {\r\n        return [];\r\n    },\r\n};\r\n","import {useCallback, useMemo, useState, useEffect} from 'react';\r\nimport {Form, Row, Col, Card, Button} from 'antd';\r\nimport {ModalContent, FormItem, Content, validateRules, useDebounceValidator} from '@ra-lib/admin';\r\nimport config from 'src/commons/config-hoc';\r\n\r\nexport default config({\r\n    modal: {\r\n        title: (props) => {\r\n            if (props?.record?.isDetail) return '查看用户';\r\n            return props.isEdit ? '编辑用户' : '新增用户';\r\n        },\r\n        width: '40%',\r\n        top: 100,\r\n    },\r\n})(function Edit(props) {\r\n    const {record, isEdit, onOk, onCancel} = props;\r\n    const [loading, setLoading] = useState(false);\r\n    const [form] = Form.useForm();\r\n    const isDetail = record?.isDetail;\r\n\r\n    const params = useMemo(() => {\r\n        return {id: record?.id};\r\n    }, [record]);\r\n\r\n    // 编辑时，回显详情数据\r\n    form.setFieldsValue(record);\r\n    // 获取部门下拉\r\n\r\n    let {run: getDepartList} = props.ajax.useGet('/depart/queryListByPage');\r\n    const [departOptions, setDepartOptions] = useState([]);\r\n    useEffect(() => {\r\n        (async () => {\r\n            let res = await getDepartList();\r\n            setDepartOptions(() => res.content || []);\r\n        })();\r\n    }, [getDepartList]);\r\n    const {run: save} = props.ajax.usePost('/subjectManage/save', null, {setLoading, successTip: '创建成功！'});\r\n    const {run: update} = props.ajax.usePost('/subjectManage/update', null, {setLoading, successTip: '修改成功！'});\r\n\r\n    const handleSubmit = useCallback(\r\n        async (values) => {\r\n            const params = {\r\n                ...values,\r\n            };\r\n            if (isEdit) {\r\n                await update(params);\r\n            } else {\r\n                await save(params);\r\n            }\r\n\r\n            onOk();\r\n        },\r\n        [isEdit, update, save, onOk],\r\n    );\r\n\r\n    const disabled = isDetail;\r\n    const layout = {\r\n        labelCol: {flex: '140px'},\r\n        disabled,\r\n    };\r\n    const colLayout = {\r\n        xs: {span: 12},\r\n        sm: {span: 12},\r\n    };\r\n    return (\r\n        <Form form={form} name=\"roleEdit\" onFinish={handleSubmit} initialValues={{}}>\r\n            <ModalContent\r\n                width={300}\r\n                loading={loading}\r\n                okText=\"保存\"\r\n                okHtmlType=\"submit\"\r\n                cancelText=\"取消\"\r\n                onCancel={() => onCancel()}\r\n                footer={disabled ? <Button onClick={onCancel}>关闭</Button> : undefined}\r\n            >\r\n                {isEdit ? <FormItem hidden name=\"id\" /> : null}\r\n                <Row gutter={24}>\r\n                    <Col span={24}>\r\n                        <FormItem\r\n                            {...layout}\r\n                            label=\"专题名称\"\r\n                            name=\"zhuantimingcheng\"\r\n                            required\r\n                            noSpace\r\n                            // rules={[{ validator: checkAccount }]}\r\n                        />\r\n                    </Col>\r\n                    <Col span={24}>\r\n                        <FormItem\r\n                            {...layout}\r\n                            type=\"select-tree\"\r\n                            label=\"专题负责部门\"\r\n                            name=\"zhuantifuzebumen\"\r\n                            required\r\n                            noSpace\r\n                            fieldKey=\"id\"\r\n                            fieldNames={{label: 'bumengmingcheng', value: 'bumengmingcheng', children: 'children'}}\r\n                            treeData={departOptions}\r\n                        />\r\n                    </Col>{' '}\r\n                    <Col span={24}>\r\n                        <FormItem {...layout} label=\"负责人\" required name=\"fuzeren\" noSpace />{' '}\r\n                    </Col>\r\n                    <Col span={24}>\r\n                        <FormItem {...layout} label=\"负责人联系方式\" required name=\"fuzerenlianxifangshi\" noSpace />{' '}\r\n                    </Col>\r\n                    <Col span={24}>\r\n                        <FormItem\r\n                            {...layout}\r\n                            type=\"select-tree\"\r\n                            label=\"相关部门\"\r\n                            required\r\n                            name=\"xiangguanbumen\"\r\n                            noSpace\r\n                            fieldKey=\"id\"\r\n                            fieldNames={{label: 'bumengmingcheng', value: 'bumengmingcheng', children: 'children'}}\r\n                            treeData={departOptions}\r\n                        />\r\n                    </Col>\r\n                    <Col span={24}>\r\n                        <FormItem type='textarea' {...layout} label=\"政策链接\" required name=\"zhengcelianjie\" noSpace />{' '}\r\n                    </Col>\r\n                    <Col span={24}>\r\n                        <FormItem type='textarea' {...layout} label=\"政策描述\" required name=\"zhuantimiaoshu\" noSpace />{' '}\r\n                    </Col>\r\n                    \r\n                </Row>\r\n            </ModalContent>\r\n        </Form>\r\n    );\r\n});\r\n","\r\nimport {useState, useMemo, useCallback, useEffect} from 'react';\r\nimport {Button, Form, Space} from 'antd';\r\nimport {PageContent, QueryBar, FormItem, Table, Pagination, Operator, ToolBar} from '@ra-lib/admin';\r\nimport config from 'src/commons/config-hoc';\r\nimport options from 'src/options';\r\nimport EditModal from './EditModal';\r\n\r\nexport default config({\r\n    path: '/subjectManage/depaSubject',\r\n})(function User(props) {\r\n    const [loading, setLoading] = useState(false);\r\n    const [pageNum, setPageNum] = useState(1);\r\n    const [pageSize, setPageSize] = useState(20);\r\n    const [conditions, setConditions] = useState({});\r\n    const [visible, setVisible] = useState(false);\r\n    const [record, setRecord] = useState(null);\r\n    const [form] = Form.useForm();\r\n\r\n    const params = useMemo(() => {\r\n        return {\r\n            ...conditions,\r\n            pageNum,\r\n            pageSize,\r\n        };\r\n    }, [conditions, pageNum, pageSize]);\r\n\r\n    // 使用现有查询条件，重新发起请求\r\n    const refreshSearch = useCallback(() => {\r\n        setConditions(form.getFieldsValue());\r\n    }, [form]);\r\n\r\n    // 获取列表\r\n    const {data: {dataSource, total} = {}} = props.ajax.useGet('/subjectManage/queryListByPage', params, [params], {\r\n        setLoading,\r\n        formatResult: (res) => {\r\n            return {\r\n                dataSource: res?.content || [],\r\n                total: res?.totalElements || 0,\r\n            };\r\n        },\r\n    });\r\n\r\n    // 删除\r\n    const {run: deleteRecord} = props.ajax.useDel('/subjectManage/:id', null, {setLoading, successTip: '删除成功！'});\r\n\r\n    const columns = [\r\n        {title: '专题名称', dataIndex: 'zhuantimingcheng'},\r\n        {title: '专题负责部门', dataIndex: 'zhuantifuzebumen'},\r\n        {title: '负责人', dataIndex: 'fuzeren'},\r\n        {title: '相关部门', dataIndex: 'xiangguanbumen'},\r\n        {title: '专题指标数(去重)', dataIndex: 'zhuantizhibiaoshu'},\r\n        {\r\n            title: '操作',\r\n            key: 'operator',\r\n            width: 200,\r\n            render: (value, record) => {\r\n                const {id, zhuantimingcheng} = record;\r\n                const items = [\r\n                    {\r\n                        label: '查看',\r\n                        onClick: () => setRecord({...record, isDetail: true}) || setVisible(true),\r\n                    },\r\n                    {\r\n                        label: '修改',\r\n                        onClick: () => setRecord(record) || setVisible(true),\r\n                    },\r\n                    {\r\n                        label: '配置',\r\n                        onClick: () => setRecord(record) || setVisible(true),\r\n                    },\r\n                    {\r\n                        label: '删除',\r\n                        color: 'red',\r\n                        confirm: {\r\n                            title: `您确定删除「${zhuantimingcheng}」吗？`,\r\n                            onConfirm: () => handleDelete(id),\r\n                        },\r\n                    },\r\n                ];\r\n\r\n                return <Operator items={items} />;\r\n            },\r\n        },\r\n    ];\r\n\r\n    const handleDelete = useCallback(\r\n        async (id) => {\r\n            await deleteRecord(id);\r\n            // 触发列表更新\r\n            refreshSearch();\r\n        },\r\n        [deleteRecord, refreshSearch],\r\n    );\r\n\r\n    const queryItem = {\r\n        style: {width: 300},\r\n    };\r\n    const queryItemDaye = {\r\n        style: {width: 300},\r\n    };\r\n    // 表格多选\r\n    const [selectedRowKeys, setSelectedRowKeys] = useState([]);\r\n    const handleSelectedRowKeysChange = useCallback((selectedRowKeys) => {\r\n        setSelectedRowKeys(selectedRowKeys);\r\n    }, []);\r\n\r\n    return (\r\n        <PageContent loading={loading}>\r\n            <QueryBar>\r\n                <Form\r\n                    name=\"user\"\r\n                    layout=\"inline\"\r\n                    form={form}\r\n                    initialValues={{position: '01'}}\r\n                    onFinish={(values) => setPageNum(1) || setConditions(values)}\r\n                >\r\n                    <FormItem {...queryItem} label=\"专题名称\" name=\"zhuantimingcheng\" />\r\n                    <FormItem {...queryItem} label=\"专题负责部门\" name=\"zhuantifuzebumen\" />\r\n                    <FormItem {...queryItem} label=\"负责人\" name=\"fuzeren\" />\r\n\r\n                    <FormItem>\r\n                        <Space>\r\n                            <Button type=\"primary\" htmlType=\"submit\">\r\n                                查询\r\n                            </Button>\r\n                            <Button onClick={() => form.resetFields()}>重置</Button>\r\n                        </Space>\r\n                    </FormItem>\r\n                </Form>\r\n            </QueryBar>\r\n            <ToolBar>\r\n                <Button type=\"primary\" onClick={() => setRecord(null) || setVisible(true)}>\r\n                    新增专题\r\n                </Button>\r\n                <Button danger onClick={() => setRecord(null) || setVisible(true)}>\r\n                    批量删除\r\n                </Button>\r\n            </ToolBar>\r\n            <Table\r\n                serialNumber\r\n                pageNum={pageNum}\r\n                pageSize={pageSize}\r\n                fitHeight\r\n                dataSource={dataSource}\r\n                columns={columns}\r\n                rowSelection={{\r\n                    selectedRowKeys: selectedRowKeys,\r\n                    onChange: handleSelectedRowKeysChange,\r\n                }}\r\n                rowKey=\"id\"\r\n            />\r\n            <Pagination\r\n                total={total}\r\n                pageNum={pageNum}\r\n                pageSize={pageSize}\r\n                onPageNumChange={setPageNum}\r\n                onPageSizeChange={(pageSize) => setPageNum(1) || setPageSize(pageSize)}\r\n            />\r\n            <EditModal\r\n                visible={visible}\r\n                record={record}\r\n                isEdit={!!record}\r\n                onOk={() => {\r\n                    setVisible(false);\r\n                    refreshSearch();\r\n                }}\r\n                onCancel={() => setVisible(false)}\r\n            />\r\n        </PageContent>\r\n    );\r\n});\r\n","import { wrapperOptions } from '@ra-lib/admin';\r\n\r\n/**\r\n * 使用 require.context 自动引入所有model文件\r\n * */\r\nconst result = {};\r\n\r\n// src/models目录下，不支持子文件夹\r\nconst req = require.context('./', false, /\\.js$/);\r\nreq.keys().forEach((key) => {\r\n    if (['./index.js'].includes(key)) return;\r\n\r\n    const model = req(key);\r\n\r\n    const options = model.default;\r\n    Object.entries(options).forEach(([k, value]) => {\r\n        if (k in result) throw Error(`${key} 文件中 key 「${k}」已被使用！请更换！`);\r\n        result[k] = value;\r\n    });\r\n});\r\n\r\nwrapperOptions(result, 1000 * 5);\r\n\r\nexport default result;\r\n","import '../../style/default.less'; // style dependencies\n// deps-lint-skip: grid\n\nimport '../../grid/style';","import '../../style/default.less'; // style dependencies\n// deps-lint-skip: grid\n\nimport '../../grid/style';","import { Row } from '../grid';\nexport default Row;","import { Col } from '../grid';\nexport default Col;"],"sourceRoot":""}